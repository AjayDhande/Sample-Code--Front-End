<!-- ==== Updated By: SneWan, Purpose: To change the UI of upload favicon ==== -->

<div class="row">
  <div class="col-sm-12 col-xs-12">
    <div class="panel panel-default">
      <div class="panel-heading">Theme</div>
      <div class="panel-body">
        <form action="/apply_default_theme" class="form-horizontal UserAdministration" role="form" enctype="multipart/form-data" method="post" id="apply_default_theme">
          <div class="col-sm-8">
            <div class="form-group">
              <!--label class="col-sm-4 control-label">Pre-selected Color Themes</label-->
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="label-padding1">
                    Pre-selected Color Themes
                  </label>
                </div>
              </div>
            <div class="col-sm-6 col-xs-12">
              <select tabindex="" class="chosen-select" name="theme_id" id="theme_id" data-placeholder="Select theme">
                <% @default_theme.each do |theme| -%>
                  <option value="<%= theme.id %>" <%= "selected" if current_theme && current_theme.theme_name.downcase == theme.theme_name.downcase %>><%= theme.theme_name.titleize %></option>
                <% end unless @default_theme.blank? %>
              </select>
              </div>
            </div>

            <div class="form-group">
              <!--h3 style="margin-top: 0px; margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 10px; padding-left: 15px;">Logo</h3-->
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="label-padding1">
                    Use Custom Logo
                  </label>
                </div>
              </div>
              <div class="col-sm-6 col-xs-12">
                <input id="logo_button" type="file" name="theme[logo_image_path]" style="padding-left:0px; width:100%;">
                <p class = "aspect_ratio" style="font-size: 12px;">Rectangular images fit best.</p>
              </div>
            </div>
            <div class="form-group">
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="label-padding1">Your Main Website's Homepage URL</label>
                </div>
              </div>
              <div class="col-sm-6 col-xs-12">
                <div class="">
                  <div>
                    <input id = "personal_url" name="theme[personal_url]" type="text" class="form-control"  value="<%=Subdomain.find(current_subdomain.id).personal_url%>">
                    <p class = "aspect_ratio" style="font-size: 12px;">To link the logo  you uploaded above to your main website, enter your URL in this format: http://www.stjohnbaptist.com</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="required label-padding1">Header</label>
                </div>
            </div>
            <div class="col-sm-6 col-xs-12">
                <div class="">
                  <textarea type="text" class="form-control" id="theme_header" placeholder="Header" name="theme[header]" value=""><%= current_theme.header if current_theme.present? %></textarea>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="required label-padding1">Your Media Store Welcome Statement</label>
                </div>
              </div>
              <div class="col-sm-6 col-xs-12">
                  <div class="">
                  <textarea style="resize: vertical;" type="text" class="form-control" id="header_description" placeholder="Description" name="theme[header_description]" value="" onkeyup="countChar(this)"><%= current_theme.header_description if current_theme.present? %></textarea>
                  <div id="textarea_feedback"></div>
                  </div>
              </div>
            </div>

            <div class="form-group">
              <div class="col-sm-4 col-xs-12">
                <div class="checkbox">
                  <label class="label-padding1">Remove Subscription Box</label>
                </div>
              </div>
              <div class="col-sm-6 col-xs-12">
                <div class="">
                  <div class="vertical-center">
                    <%=check_box_tag :subscription_check, '1',Subdomain.find(current_subdomain.id).subscription_check %>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ==== To change the UI of upload favicon Start ==== -->
          <div class="col-sm-4 tab-pane1" >
            <div class="form-group">
              <div class="col-sm-8 col-xs-12" style="padding-left:0px;">   
                <div class="col-sm-12">
                 <!--  <p class="" style="padding-left:0px;margin-left: 0%;text-align: justify;"> -->
                 <div class="up">
                   Upload Your Favicon
                  </div>
                  <!-- </p> -->
                </div>
              </div>
       <!--        <div class="col-sm-8 col-xs-12"></div> -->
     <!--   <br /> -->
              
              <div class="col-sm-12">
             <hr> 

                <!-- <div class="panel-heading">
                  <div class="text-allignment">Upload your page Favicon</div>
                </div> -->
                <div class="panel-body">
                  <div class="text-alignment">
                    <p class="textstyle">Favicon's are the little icons on the tabs of your website's browser. Online Church Media's favicon looks like this.  
                    <img id="image" src="<%= asset_path 'favicon-32x32.png' %>"/>
                     </p>
                    <p class="textstyle">The favicon is a small picture in .ICO or .PNG format.</p>
                    <p class="textstyle">Non-square pictures are not supported. To generate a favicon, I suggest you to use this favicon generator at the 'Favicon' website by clicking on the 'Go To Favikon.com' button below.</p>
                    <p class="textstyle">We have provided you a default favicon to until you've uploaded your own.</p>
                  </div> 

                  <div class="col-sm-8 col-xs-12 changeui">
                    <input type="file" class="filestyle" data-input="false" data-buttonText="Upload Favicon" name="theme[favicon_logo]">
                  </div>
                   <div class="col-sm-8 col-xs-6"><input class="favi1 form-control" style="color: white!important;font-weight: bold;margin-top: 6px;
                    " TYPE="button" VALUE="Go To Favikon.com" id="colorzilla">
                   </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ==== To change the UI of upload favicon End ==== -->

          <div class="form-group">
            <div class="col-sm-6 col-sm-offset-4">
              <div class="button-allignment">
                <input type="button" value="Apply" class="btn btn-info" id="apply_theme">
                <button class="btn btn-default" type="button" id="customize">Customize Theme</button>
              </div>
            </div>
          </div> 
        </form>         
      </div>
    </div>
  </div>
</div>



<%=javascript_include_tag 'theme.js', 'theme1.js', 'bootstrap-filestyle.min.js', 'bootstrap-filestyle.js' %>

<script type="text/javascript">
  // $(document).ready(function(){
  //   $('.fileinput-button').bootstrapFileInput(); 
  //   $('.fileinput-button').removeClass('btn-default').addClass('favicon_tab');
  //   $('.fileinput-button').html("Upload Favicon"); 
  // });

  //To add changes in upload favicon button
  $(function(){
    $($('.changeui').find('label')).css("width", "341px");
    $($('.changeui').find('label')).css("height", "41px");
    $($('.changeui').find('label')).css("margin-left", "-29px");
    $($('.changeui').find('label')).css("background-color", "rgba(115, 173, 33, 0.72)");
    $($('.changeui').find('label')).css("icon", "false");
    $($('.changeui').find('span')[1]).removeClass('icon-span-filestyle glyphicon glyphicon-folder-open');
    $($('.changeui').find('span')[2]).css("color", "white");
    $($('.changeui').find('span')[2]).css("font-size", "17px");   
    $($('.changeui').find('span')[2]).css("font-weight", "bold");
    //$(".filestyle").filestyle({buttonText: "Upload Favicon"});
  })
  
  $("#apply_theme").click(function() {
    var flag = false;
    var extensions = [ "jpg","JPG", "png","PNG", "gif","GIF", "jpeg","JPEG","ico"];
    var extensions1 = [ "png","ico"];
    var logo_file_path = $("[name='theme[logo_image_path]']").val();
    var favicon_file_path = $("[name='theme[favicon_logo]']").val();
    var logo_file_extension = logo_file_path.split('.').pop();
    var favicon_file_extension = favicon_file_path.split('.').pop();
    var logo_valid = $.inArray(logo_file_extension, extensions) > -1;
    var favicon_valid = $.inArray(favicon_file_extension, extensions1) > -1;
    var theme_header = $("textarea[name='theme[header]']").val();

    var header_description = $("textarea[name='theme[header_description]']").val();

    if (logo_file_path != ""){
      if (logo_valid == false){
        var  logo_image_element =  $("[name='theme[logo_image_path]']")
        var message = "Please browse only jpg/JPG, png/PNG, jpeg/JPEG or gif/GIF image"
        addError(logo_image_element,message)
        flag = true;
      }
      if (logo_valid == true){
        var  logo_image_element =  $("[name='theme[logo_image_path]']")
        removeError(logo_image_element,message)
      }

      // if ((window.logo_image.width < 260) || (window.logo_image.height < 60)){
      //      console.log("width is less");  
      //     var  logo_image_element =  $("[name='theme[logo_image_path]']")
      //     var message = "Please upload image with minimum width of 260 and minimum height of 60"
      //     addError(logo_image_element,message)   
      //     flag = true;          
      //  }
    }
    if (favicon_file_path != ""){
      if (favicon_valid == false){
        var  favicon_image_element =  $("[name='theme[favicon_logo]']")
        var message = "Please browse only png,ico favicon image"
        addError(favicon_image_element,message)
        flag = true;
      }
      if (favicon_valid == true){
        var  favicon_image_element =  $("[name='theme[favicon_logo]']")
        removeError(favicon_image_element,message)
      }

      if ((window.logo_image.width > 16) || (window.logo_image.height > 16)){
          console.log("width is less");  
          var  favicon_image_element =  $("[name='theme[favicon_logo]']")
          var message = "Please upload favicon image with width of 16 and height of 16"
          addError(favicon_image_element,message)   
          flag = true;          
      }
    }
    if (theme_header == "") {
        var element = $("textarea[name='theme[header]']")
        var message = "Header field can't be blank"
        addError(element, message)
        flag = true;
    }
    else if(theme_header.length > 60){
        var element = $("textarea[name='theme[header]']")
        var message = "Header field should be less than or equal to 60 characters"
        addError(element, message)
        flag = true;
    }
    else{
        var element = $("textarea[name='theme[header]']")
        removeError(element)
    };
    if (header_description == "") {
        var element = $("textarea[name='theme[header_description]']")
        var message = "Your Site Welcome Message field can't be blank"
        addError(element, message)
        flag = true;
    }
    else if(header_description.length > 450){
        var element = $("textarea[name='theme[header_description]']")
        var message = "Welcome Message should be less than or equal to 450 characters"
        addError(element, message)
        flag = true;
    }
    else {
        var element = $("textarea[name='theme[header_description]']")
        removeError(element)
    };

    if(flag)
        return false;
    showLoader();
    $("#apply_default_theme").submit();

  })

//Purpose: To Add error message for Plans
//Date: 07/01/2015
function addError(element,message){
  if(!$(element.parent()).find('div.theme_image_error').length > 0){
    $(element.parent()).append('<div class="theme_image_error" style="padding:0px;">'+ message + '</div>');
    $(element.parent()).find('div.theme_image_error').siblings('div').addClass('set_tag_field');
  }
}

//Purpose: To Remove error message for Plans
//Date: 07/01/2015
function removeError(element){
  if($(element.parent()).find('div.theme_image_error').length > 0){
    $(element.parent()).find('div.theme_image_error').remove();
  }
}
</script>

<style type="text/css">
  .tab-pane {
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    border-radius: 0px 0px 5px 5px;
    padding: 10px;
  }

  .nav-tabs {
    margin-bottom: 0;
    padding: 9%;
  }

  .favicon_tab{
    padding-bottom: 9%;
    width: 179%;
    color: white;
    margin-left: -15%;
    margin-bottom: 6%;
  }

  .link{
    color: white;
    text-decoration: initial;
  }
  a:hover, a:focus {
    color: white;
    text-decoration: initial;
  }
  .btn:hover, .btn:focus {
    color: white;
    text-decoration: none;
  }
  
  .favi{
    display:block;text-align:center;margin-top:20%;background-color: rgba(115, 173, 33, 0.72);border-bottom: 2px solid #688413;border-left: 2px solid #688413;color:white;padding-bottom: 1%;
  }
</style>

<%= stylesheet_link_tag  'chosen.min.css','bootstrap-tagsinput.css', 'summernote.css',"upload.css", "uploaded_mediums.css","dev_custom.css" %>
<%= javascript_include_tag 'bootstrap-tagsinput.min.js',"chosen.jquery.js", 'summernote.min.js',  'chosen-select.js', 'jquery.loadTemplate-1.4.4.min.js',"new_upload.js" %>
<%= javascript_include_tag  "bootstrap.file-input.js"%>
  

<script type="text/javascript">
  $(document).ready(function(){
    $("#colorzilla").click(function(){
      //window.location.href = "http://www.colorzilla.com/";
      window.open("http://www.favikon.com/");
    });
    //window.location.href='http://www.colorzilla.com/";

  });
</script>
<style type="text/css">
/*a.button {
    -webkit-appearance: button;
    -moz-appearance: button;
    appearance: button;

    text-decoration: none;
    color: initial;
}*/

 .tab-pane1 {
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    border-radius: 0px 0px 5px 5px;
    padding: 2%;
   padding-bottom: 0%;
  }

  .favi1{
      display:block;text-align:center;margin-top:20%;
      background-color: rgba(53, 53, 53, 0.53);
     /*border-bottom: 2px solid #688413;*/
     /*border-left: 2px solid #688413;*/
      color: white!important;
      padding-bottom: 1%;
      border-radius: 4px;width: 324px;
   /* margin-left: -27px;*/
      margin-left: -28px;
      height: 42px;
      font-size: 16px;
      width: 188%;
}
input.favi1{
  color: white;
}
.up
{
  font-weight: bold;
  padding-left:0px;
  color: #ff8700;
  text-align: justify;
}
.btn btn-default:hover
{
  background-color: yellow;
}
.text-alignment
{
/*margin-left: -15px;*/
margin-left: -5%;
text-align: justify;
margin-top: -7%;
}
/*.textstyle
{
font-size: 14px;
font-family: callibri;
}
*/
  </style>